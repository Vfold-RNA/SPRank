#pragma once

#include <limits>
#include <cmath>
#include <vector>
#include <array>
#include <map>
#include <string>
#include <cassert>

#include "common.h"
#include "str.h"
#include "vec3d.h"

namespace sprank {

enum ELEM_ENUM {
    EE_H = 0, EE_C, EE_N, EE_O, EE_P, EE_S, EE_HA, EE_UNK, EE_SIZE
};

const Floats elem_radii = {
    1.00, 1.70, 1.65, 1.50, 1.90, 1.80, 1.70, 1.70
};

struct Parameter {
    const Float T = 25.0;
    const Float rt_to_kcal_per_mol = 0.593*(273+T)/(273+25); // 1 mol of kT = 1 RT = 0.593 kcal/mol for T = 298K

    const Float gamma_SASA =  0.0054;
    const Float r_water = 1.4;
    std::vector<std::vector<Vec3d>> sasa_points;

    const Float pairwise_dis_upper_bound = 10.0;
    const Float pairwise_bin_size = 0.5;
    const Size_Type pairwise_bin_num = 20;
    Floats bin_volumes = Floats(pairwise_bin_num, 0.0);

    std::map<std::string,Floats> pairwise_potentials_map;

    Parameter(const std::string pairwise_potentials_path) {
        for(Size_Type bin_i = 0; bin_i != this->pairwise_bin_num; ++bin_i) {
            bin_volumes[bin_i] = 4.0*k_pi/3.0 * Float((bin_i+1)*(bin_i+1)*(bin_i+1) - bin_i*bin_i*bin_i) * this->pairwise_bin_size*this->pairwise_bin_size*this->pairwise_bin_size;
        }
        this->generate_sasa_table();

        if(pairwise_potentials_path != "") {
            std::string sline;
            std::ifstream in_pp(pairwise_potentials_path, std::ios::in);
            while(std::getline(in_pp, sline)) {
                if(sline.size() == 0) {
                    continue;
                }
                const std::vector<std::string> token = string2vector(sline);
                assert(token.size() == (pairwise_bin_num+1));
                const std::string &p_name = token[0];
                this->pairwise_potentials_map[p_name] = Floats(this->pairwise_bin_num, 0.0);
                for(int i = 1; i != token.size(); ++i) {
                    this->pairwise_potentials_map.at(p_name)[i-1] = std::stod(token[i]);
                }
                assert(this->pairwise_potentials_map.at(p_name).size() == pairwise_bin_num);
            }
            in_pp.close();
        } else {
            this->pairwise_potentials_map = {
                {"NB-O.o1", {3.000,3.000,3.000,3.000,2.631,3.365,-0.691,0.179,0.251,-0.702,1.086,-0.070,-1.269,-0.789,-1.421,-2.311,-0.867,-0.708,-0.892,0.000}},
                {"CQ-N.nc", Floats(this->pairwise_bin_num, 0.0)},
                {"C-O.os", {3.000,3.000,3.000,3.000,2.972,3.258,2.985,-2.474,1.432,0.337,-1.215,-0.585,0.382,1.347,0.607,-0.476,-0.765,-0.575,-0.137,0.000}},
                {"C-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"CS-N.nc", Floats(this->pairwise_bin_num, 0.0)},
                {"CA-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"OH-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"OS-N.na", {3.000,3.000,3.000,3.000,2.349,2.263,0.817,-0.181,-0.479,0.303,-0.094,-0.806,-0.222,-1.166,-1.619,-1.393,-1.275,-0.798,-0.161,0.000}},
                {"CA-O.oh", {3.000,3.000,3.000,3.000,2.788,1.435,0.690,0.739,1.234,0.351,-0.926,-0.021,-0.297,-0.202,0.040,-1.696,-1.731,-0.053,0.356,0.000}},
                {"CT-C.c", {3.000,3.000,3.000,3.000,2.541,2.639,3.132,-0.732,-1.352,0.058,-1.539,0.524,-0.197,-0.873,-0.333,0.153,-0.772,-1.557,-0.505,0.000}},
                {"NA-C.c3", {3.000,3.000,3.000,3.000,2.567,2.741,2.586,0.197,-1.421,-1.381,-3.100,-2.450,-1.043,-1.170,-0.673,-0.262,-0.387,-0.597,0.131,0.000}},
                {"NC-N.nb", {3.000,3.000,3.000,3.000,3.159,2.526,-0.003,-3.723,-2.882,-1.382,-0.830,0.487,1.574,-1.048,0.612,-0.740,-0.214,0.527,-0.595,0.000}},
                {"O-C.c3", {3.000,3.000,3.000,3.000,4.044,4.966,-3.288,-3.132,-0.399,0.751,-0.270,2.523,1.830,0.544,1.027,-0.450,-0.225,-0.439,0.787,0.000}},
                {"RBA-R.cn", {3.000,3.000,3.000,3.000,3.203,3.958,3.767,0.547,-1.172,-0.926,-0.752,-0.658,-0.279,-0.889,0.512,-1.212,-0.417,-0.566,-0.514,0.000}},
                {"CT-O.os", {3.000,3.000,3.000,3.000,2.050,2.287,1.280,-0.456,-0.698,-1.612,-0.502,-1.893,-0.658,-1.464,-1.650,-1.069,-1.230,-0.708,-1.050,0.000}},
                {"CA-N.na", {3.000,3.000,3.000,3.000,2.265,2.746,0.165,-3.619,-0.515,-0.763,-1.887,-1.240,0.673,-1.757,-1.975,-1.091,-0.899,-0.241,-0.338,0.000}},
                {"O-C.cc", {3.000,3.000,3.000,3.000,3.578,4.899,-1.869,-3.133,-1.199,-2.368,-0.509,0.401,-1.137,-0.884,-0.592,-0.962,-0.686,0.313,-0.304,0.000}},
                {"P-N.nh", {3.000,3.000,3.000,3.000,4.111,4.326,0.818,0.457,2.180,2.540,1.247,0.545,1.676,2.586,2.325,0.503,0.426,1.668,0.908,0.000}},
                {"NC-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"C4-C.ca", {3.000,3.000,3.000,3.000,2.138,0.803,-0.810,-2.157,-0.238,0.198,0.679,-0.460,-0.610,-0.295,-2.193,-2.074,-1.467,-1.211,-0.701,0.000}},
                {"NA-N.n4", {3.000,3.000,3.000,3.000,2.158,2.400,-0.689,-0.649,-0.915,-1.996,-0.374,-4.830,-1.209,-0.747,-1.256,-1.969,-0.256,-0.958,-0.180,0.000}},
                {"CI-C.cc", {3.000,3.000,3.000,3.000,2.725,2.744,2.821,2.546,0.493,1.236,-0.303,0.358,0.927,0.086,-0.912,0.186,-0.259,-1.019,-1.293,0.000}},
                {"NA-C.cc", {3.000,3.000,3.000,3.000,2.401,3.119,-2.960,-5.767,-2.658,-2.636,-0.857,0.590,-0.010,-1.013,-1.393,-0.995,-1.499,-0.758,-0.529,0.000}},
                {"C4-N.nc", Floats(this->pairwise_bin_num, 0.0)},
                {"N*-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"C5-C.c", Floats(this->pairwise_bin_num, 0.0)},
                {"OS-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"P-N.nc", Floats(this->pairwise_bin_num, 0.0)},
                {"CB-N.nh", {3.000,3.000,3.000,3.000,2.274,2.877,0.545,-3.062,-3.160,-1.500,-1.168,-1.062,-0.464,-1.262,-2.386,-2.183,-0.820,-0.115,-0.036,0.000}},
                {"NC-C.c3", {3.000,3.000,3.000,3.000,2.720,2.988,2.670,-0.461,-2.432,-2.845,-1.113,-1.078,-1.422,-0.244,-0.020,-0.720,-0.987,-0.627,0.080,0.000}},
                {"O-N.n4", {3.000,3.000,3.000,3.000,0.864,-3.747,-2.425,-0.164,-1.033,-1.762,2.244,-0.475,0.805,-0.828,0.223,0.752,-0.384,-0.215,-0.434,0.000}},
                {"O-N.na", {3.000,3.000,3.000,3.000,1.555,-1.810,-3.649,0.202,-1.253,-1.986,-3.181,-1.180,-0.014,-1.028,-1.832,-0.398,-1.006,-1.278,0.098,0.000}},
                {"N*-C.cc", {3.000,3.000,3.000,3.000,2.677,2.722,1.803,-2.154,-4.119,-0.992,-0.653,-0.666,0.551,0.163,-0.858,-0.292,-0.720,-0.585,0.680,0.000}},
                {"NC-O.o2", {3.000,3.000,3.000,3.000,3.828,3.738,-0.516,-3.319,-1.127,-1.627,-0.636,0.126,0.954,0.339,-1.441,-1.195,1.089,0.811,0.278,0.000}},
                {"CI-C.ca", {3.000,3.000,3.000,3.000,2.915,3.018,1.110,0.276,0.461,-0.805,-0.247,0.008,-0.096,0.587,0.591,0.095,-0.724,0.219,-1.017,0.000}},
                {"O2-N.nh", {3.000,3.000,3.000,3.000,4.200,-1.747,0.802,1.547,1.028,0.224,2.538,1.415,0.804,1.711,1.017,1.657,0.230,0.217,0.877,0.000}},
                {"CS-C.c", Floats(this->pairwise_bin_num, 0.0)},
                {"O-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"O2-C.cc", {3.000,3.000,3.000,3.000,2.966,3.100,3.076,1.151,0.577,1.658,-0.046,0.026,0.388,0.476,0.105,-1.258,-0.107,-0.116,-0.164,0.000}},
                {"NC-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"O2-C.c", {3.000,3.000,3.000,3.000,3.979,4.549,3.883,2.455,2.490,2.594,1.121,1.405,0.927,1.291,2.166,1.014,-0.817,0.915,1.303,0.000}},
                {"CT-N.n4", {3.000,3.000,3.000,3.000,3.217,3.300,1.103,1.798,2.789,0.658,-0.271,-0.849,0.253,0.968,0.700,0.078,0.299,-0.074,-1.080,0.000}},
                {"CQ-N.nh", Floats(this->pairwise_bin_num, 0.0)},
                {"NB-N.na", Floats(this->pairwise_bin_num, 0.0)},
                {"P-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"NA-N.nh", {3.000,3.000,3.000,3.000,2.759,5.196,0.636,-4.430,-3.601,-0.482,-1.841,-0.089,0.021,-1.128,-0.054,-0.050,-0.656,-0.246,0.020,0.000}},
                {"CS-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"C5-N.nb", Floats(this->pairwise_bin_num, 0.0)},
                {"C5-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"RBA-P.*", {3.000,3.000,3.000,3.000,2.560,2.635,3.103,0.101,-0.108,0.001,0.485,-0.083,0.025,-0.066,-1.228,-0.410,-0.902,-0.590,-1.421,0.000}},
                {"NC-N.nh", {3.000,3.000,3.000,3.000,3.771,1.687,-2.779,-3.398,0.517,-2.234,-0.844,0.227,0.073,-0.935,-0.069,-0.624,-0.421,-0.124,1.048,0.000}},
                {"C4-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"C-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"C-O.oh", {3.000,3.000,3.000,3.000,2.828,2.348,3.486,-0.288,0.626,-0.557,-3.771,-0.162,-0.030,0.095,-1.222,0.058,-0.331,-0.220,-0.259,0.000}},
                {"CT-C.c3", {3.000,3.000,3.000,3.000,2.727,2.691,3.020,1.615,-0.307,-2.515,-0.863,-0.310,-1.388,-0.099,0.127,0.485,-0.605,-0.466,-0.660,0.000}},
                {"CP-N.nc", Floats(this->pairwise_bin_num, 0.0)},
                {"C-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"OH-C.cc", {3.000,3.000,3.000,3.000,3.063,3.749,-0.632,-3.102,1.556,0.849,-0.713,-0.602,-0.362,-1.122,-0.495,-0.160,0.530,0.037,-0.760,0.000}},
                {"NA-C.c", Floats(this->pairwise_bin_num, 0.0)},
                {"O2-N.nc", {3.000,3.000,3.000,3.000,3.568,3.619,3.670,3.769,1.725,3.878,2.635,1.947,1.599,1.524,1.112,0.031,0.030,0.424,-0.313,0.000}},
                {"OS-O.o2", {3.000,3.000,3.000,3.000,3.130,2.062,1.189,0.484,-0.827,-0.621,0.586,0.685,0.110,-1.468,0.053,-0.742,-0.423,0.446,-0.961,0.000}},
                {"C5-O.oh", Floats(this->pairwise_bin_num, 0.0)},
                {"C5-O.o1", Floats(this->pairwise_bin_num, 0.0)},
                {"CP-O.os", Floats(this->pairwise_bin_num, 0.0)},
                {"C4-N.nb", Floats(this->pairwise_bin_num, 0.0)},
                {"P-C.c", Floats(this->pairwise_bin_num, 0.0)},
                {"CT-N.na", {3.000,3.000,3.000,3.000,2.777,3.023,2.869,-0.947,1.461,-0.131,-0.951,-2.423,0.673,-0.250,-0.287,-0.399,0.001,0.466,-0.984,0.000}},
                {"NB-O.oh", {3.000,3.000,3.000,3.000,0.983,1.658,1.564,-0.850,0.230,1.647,2.432,-0.350,-1.442,0.947,0.024,0.075,-0.375,-0.365,-0.061,0.000}},
                {"CT-N.n", {3.000,3.000,3.000,3.000,2.816,2.977,2.306,1.611,-0.123,0.308,0.135,-0.507,-0.592,-0.723,-1.070,-1.358,-0.196,-0.076,0.567,0.000}},
                {"N2-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"N2-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"NC-O.oh", {3.000,3.000,3.000,3.000,0.759,-0.246,2.756,-0.080,1.538,0.562,0.909,0.378,0.441,1.064,-0.171,-1.363,-0.071,0.544,1.010,0.000}},
                {"CA-N.nh", {3.000,3.000,3.000,3.000,3.539,2.133,2.956,-3.676,0.686,0.731,-0.386,-1.278,-0.670,0.813,-0.839,0.667,1.005,0.654,0.657,0.000}},
                {"NB-C.cc", {3.000,3.000,3.000,3.000,3.050,3.613,1.536,-2.128,0.394,0.765,-0.272,0.250,0.763,-1.405,-0.951,0.480,0.653,-0.697,0.129,0.000}},
                {"P-O.os", {3.000,3.000,3.000,3.000,2.571,2.583,2.220,-0.157,1.564,-1.043,-0.056,-1.733,0.051,-0.523,-0.455,-0.576,-1.061,-0.105,-0.524,0.000}},
                {"OH-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"N2-C.c", {3.000,3.000,3.000,3.000,2.882,4.187,-2.930,-4.536,-2.659,-0.615,-0.281,0.453,-0.761,-1.144,0.168,-0.277,-0.489,0.593,-0.462,0.000}},
                {"CP-C.cc", {3.000,3.000,3.000,3.000,3.895,4.007,1.536,0.832,1.404,-0.043,0.367,1.818,1.093,0.658,1.171,-0.175,1.509,0.563,2.072,0.000}},
                {"C-O.o1", {3.000,3.000,3.000,3.000,3.005,3.074,-0.123,0.160,0.686,1.051,-0.547,0.010,-1.296,-0.031,-0.556,0.008,-0.789,0.513,-0.244,0.000}},
                {"OH-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"NB-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"C5-N.nc", Floats(this->pairwise_bin_num, 0.0)},
                {"CB-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"CA-C.cc", {3.000,3.000,3.000,3.000,3.242,4.023,0.024,-2.562,-1.362,-0.045,-0.255,1.270,1.159,-1.173,-0.278,-0.322,0.441,0.627,0.796,0.000}},
                {"CB-N.na", {3.000,3.000,3.000,3.000,3.086,2.786,0.736,-0.607,-2.767,-0.408,0.491,1.817,-0.713,0.328,-0.760,-0.707,0.330,0.068,0.706,0.000}},
                {"CS-C.ca", {3.000,3.000,3.000,3.000,3.216,3.420,0.579,-0.656,-2.010,0.495,0.092,0.253,-0.971,1.106,0.826,-0.473,0.235,1.403,-0.554,0.000}},
                {"NA-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"NC-O.o1", {3.000,3.000,3.000,3.000,3.597,2.745,2.922,0.731,0.869,0.630,-0.819,-0.115,-0.155,1.161,1.106,-0.321,0.125,-0.501,0.431,0.000}},
                {"CA-C.c3", {3.000,3.000,3.000,3.000,3.493,3.862,3.830,1.448,-0.756,-0.637,-0.175,1.854,-0.719,-0.740,0.638,0.919,-0.111,0.649,0.704,0.000}},
                {"OS-C.cc", {3.000,3.000,3.000,3.000,3.186,3.538,1.571,1.157,0.394,0.458,0.568,-0.089,1.247,-0.416,-0.435,-0.800,0.849,0.022,0.299,0.000}},
                {"NA-N.nb", {3.000,3.000,3.000,3.000,3.234,-4.279,4.462,-4.544,2.470,-0.434,-0.046,0.418,-1.314,-0.368,0.088,0.496,-0.388,-0.223,0.982,0.000}},
                {"NC-O.os", {3.000,3.000,3.000,3.000,2.701,3.183,-1.048,-0.888,-0.642,-1.960,-0.701,-0.350,-0.161,-0.163,-0.497,-0.882,-0.214,0.231,-0.615,0.000}},
                {"N*-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"CA-N.n4", {3.000,3.000,3.000,3.000,2.716,2.933,3.397,0.536,-1.845,0.176,-0.689,-1.798,-0.999,-1.693,-1.021,-0.809,-0.185,-0.496,0.767,0.000}},
                {"OS-N.n", {3.000,3.000,3.000,3.000,2.697,3.174,2.485,0.156,0.426,1.565,1.166,-0.446,-0.993,-0.131,-0.278,-1.968,0.669,-1.137,-0.872,0.000}},
                {"CB-N.n", {3.000,3.000,3.000,3.000,2.784,3.244,2.015,-3.272,-1.734,-0.779,0.263,-2.157,0.524,-1.362,-1.179,0.627,-0.247,0.240,0.223,0.000}},
                {"C5-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"CI-N.n4", {3.000,3.000,3.000,3.000,3.019,3.137,2.348,0.842,-0.320,0.350,0.557,0.515,0.602,-1.497,0.248,-0.444,-0.146,-0.685,0.125,0.000}},
                {"CP-O.oh", Floats(this->pairwise_bin_num, 0.0)},
                {"O2-N.n4", {3.000,3.000,3.000,3.000,0.833,-4.769,0.079,-3.517,-1.325,-1.458,-1.888,-0.669,-1.113,-1.522,-1.055,0.402,-0.457,-0.211,-0.602,0.000}},
                {"C-C.c", {3.000,3.000,3.000,3.000,2.220,2.823,0.034,-0.607,-1.896,-2.762,-1.369,0.504,-1.279,-0.520,-1.601,-0.943,-1.704,-0.891,-0.352,0.000}},
                {"CI-N.na", Floats(this->pairwise_bin_num, 0.0)},
                {"CQ-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"CS-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"CQ-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"C4-O.o1", Floats(this->pairwise_bin_num, 0.0)},
                {"N2-N.nc", {3.000,3.000,3.000,3.000,3.464,4.016,-0.710,-2.729,-0.446,-1.515,0.460,-1.204,-1.000,-0.599,-1.054,0.264,0.506,0.819,0.219,0.000}},
                {"RBB-HA.*", {3.000,3.000,3.000,3.000,3.670,2.755,1.115,-0.946,-0.608,1.628,-0.600,0.047,0.894,0.223,-0.172,0.560,0.588,-0.320,0.259,0.000}},
                {"CT-O.o2", {3.000,3.000,3.000,3.000,3.489,2.659,0.002,-0.104,1.201,0.893,0.744,0.172,1.400,0.622,-0.155,0.556,-0.225,0.115,0.051,0.000}},
                {"C-N.na", {3.000,3.000,3.000,3.000,2.775,3.311,0.633,-4.497,-0.888,0.118,-1.905,-1.646,0.576,-0.548,-0.521,-0.960,0.112,0.050,0.383,0.000}},
                {"CP-C.ca", {3.000,3.000,3.000,3.000,4.205,4.440,0.407,0.068,-0.187,0.392,1.957,0.993,0.952,2.532,1.458,2.442,-0.064,1.557,1.653,0.000}},
                {"OS-N.n4", {3.000,3.000,3.000,3.000,4.270,0.186,2.138,1.846,1.990,2.148,0.201,0.701,0.463,1.443,0.446,0.967,1.145,0.848,1.097,0.000}},
                {"NC-N.n", {3.000,3.000,3.000,3.000,2.806,-2.936,-0.998,-4.408,-1.633,-0.726,-2.703,-1.631,1.226,-1.909,-0.398,-1.156,0.044,0.086,0.106,0.000}},
                {"O-N.nb", {3.000,3.000,3.000,3.000,3.217,3.281,-1.748,-3.484,2.020,-2.329,-0.418,-0.184,0.210,-0.165,-1.791,0.124,-0.359,-0.019,-0.606,0.000}},
                {"N2-N.n4", {3.000,3.000,3.000,3.000,2.875,2.312,2.291,-1.466,-1.444,-3.274,0.180,-0.384,-0.360,-1.826,-1.314,-1.400,-0.371,-1.102,-0.377,0.000}},
                {"C4-N.na", Floats(this->pairwise_bin_num, 0.0)},
                {"CP-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"NB-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"NB-N.nh", {3.000,3.000,3.000,3.000,3.051,2.287,0.078,-3.077,-1.434,-0.160,-2.255,-0.883,-0.147,-0.219,-3.484,0.040,-0.157,-0.724,0.117,0.000}},
                {"RBA-HA.*", {3.000,3.000,3.000,3.000,4.066,1.599,-3.436,-1.663,1.404,0.127,-0.236,0.553,1.301,-0.434,-1.005,-0.710,0.784,0.483,-0.231,0.000}},
                {"CI-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"CI-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"OH-O.o1", {3.000,3.000,3.000,3.000,-1.417,-0.924,1.605,-3.034,0.417,-1.365,-0.030,-0.474,-1.060,0.834,-0.811,-0.183,0.020,-0.114,-0.668,0.000}},
                {"CS-N.n4", Floats(this->pairwise_bin_num, 0.0)},
                {"O2-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"C-C.c3", {3.000,3.000,3.000,3.000,3.045,3.062,1.906,0.788,-2.737,-2.629,-0.709,0.994,0.521,0.068,-0.531,-0.780,0.346,0.203,0.001,0.000}},
                {"N2-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"P-N.nb", Floats(this->pairwise_bin_num, 0.0)},
                {"CS-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"CP-N.na", Floats(this->pairwise_bin_num, 0.0)},
                {"CT-N.nh", {3.000,3.000,3.000,3.000,3.577,4.173,4.630,-0.073,1.863,0.992,-0.450,-0.878,0.993,0.513,0.949,0.698,-0.598,0.882,0.433,0.000}},
                {"CA-N.nb", {3.000,3.000,3.000,3.000,2.654,3.206,1.452,-3.366,-1.513,-0.429,-0.971,0.150,-0.124,-1.345,-1.163,-0.403,-0.003,0.190,-0.367,0.000}},
                {"N*-N.nb", {3.000,3.000,3.000,3.000,2.914,3.133,-0.447,-0.230,-1.541,-1.591,-0.973,-0.515,1.179,-1.730,-1.407,0.733,0.038,1.100,0.484,0.000}},
                {"OH-N.na", Floats(this->pairwise_bin_num, 0.0)},
                {"CP-C.c", Floats(this->pairwise_bin_num, 0.0)},
                {"N*-C.c3", {3.000,3.000,3.000,3.000,2.771,2.720,1.883,1.090,-0.523,-1.668,-0.972,-0.791,1.001,-0.625,0.573,0.176,-1.040,-1.131,0.044,0.000}},
                {"CS-C.cc", {3.000,3.000,3.000,3.000,2.896,2.963,2.352,-3.262,0.221,0.802,0.601,0.180,-2.397,0.905,-1.877,-0.462,0.165,0.782,0.352,0.000}},
                {"NB-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"NA-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"NB-O.os", {3.000,3.000,3.000,3.000,3.311,2.197,3.114,0.787,-0.693,0.050,0.707,0.921,-0.671,0.647,0.462,-0.454,0.282,-0.003,0.202,0.000}},
                {"CP-N.n4", Floats(this->pairwise_bin_num, 0.0)},
                {"RBB-S.*", {3.000,3.000,3.000,3.000,2.611,1.517,2.310,-0.368,0.399,0.063,-1.571,-0.431,0.486,-0.561,-1.066,-1.196,-1.045,-0.606,-0.875,0.000}},
                {"P-C.c3", {3.000,3.000,3.000,3.000,3.137,3.226,3.879,1.063,-2.848,-1.467,0.870,-1.235,1.066,0.125,-1.000,0.770,0.532,0.189,0.578,0.000}},
                {"CQ-O.oh", Floats(this->pairwise_bin_num, 0.0)},
                {"OS-C.ca", {3.000,3.000,3.000,3.000,2.982,1.959,0.082,-0.711,-0.372,0.136,0.398,-0.877,0.034,0.370,-1.102,-0.584,-0.364,-0.261,0.320,0.000}},
                {"NA-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"CI-C.c3", {3.000,3.000,3.000,3.000,2.765,2.855,3.590,2.308,-0.666,-0.188,-1.518,-0.561,0.496,0.118,0.077,-0.974,-1.517,-0.429,-0.075,0.000}},
                {"OH-N.nh", {3.000,3.000,3.000,3.000,4.569,2.731,1.654,0.540,0.836,0.756,-0.091,0.454,-0.232,1.775,1.791,-0.274,0.363,0.947,1.202,0.000}},
                {"P-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"CA-O.o1", {3.000,3.000,3.000,3.000,4.178,4.351,2.449,-0.638,-0.059,1.813,-0.287,2.199,2.304,1.778,1.365,-0.030,0.461,1.125,1.992,0.000}},
                {"C5-C.c3", {3.000,3.000,3.000,3.000,2.694,2.873,2.583,0.454,-0.322,-1.578,0.215,0.429,-1.274,0.776,-0.574,-0.731,-1.064,-0.480,-0.492,0.000}},
                {"NB-C.c3", {3.000,3.000,3.000,3.000,3.141,3.560,0.640,-3.337,1.273,-1.286,1.058,0.725,0.491,-0.634,-0.681,-1.365,-0.481,-1.180,0.103,0.000}},
                {"CA-O.os", {3.000,3.000,3.000,3.000,2.910,3.186,0.884,-1.298,-1.098,-0.624,0.153,1.221,0.026,0.116,-1.571,-0.399,0.694,0.420,-0.898,0.000}},
                {"OS-O.os", {3.000,3.000,3.000,3.000,2.976,3.150,0.562,0.416,0.682,0.268,-0.396,-0.481,-0.145,-0.177,0.049,-0.947,-0.403,-0.109,1.020,0.000}},
                {"OH-C.ca", {3.000,3.000,3.000,3.000,3.049,3.230,0.442,-1.054,1.716,-0.981,0.342,-2.077,0.518,-0.719,-0.347,-0.104,-0.295,-0.478,-0.673,0.000}},
                {"CI-N.nc", Floats(this->pairwise_bin_num, 0.0)},
                {"C4-C.c3", {3.000,3.000,3.000,3.000,3.310,3.178,2.829,1.718,0.683,0.582,1.777,1.607,0.785,1.605,-0.302,-0.823,-0.461,-0.412,-0.170,0.000}},
                {"NC-N.na", {3.000,3.000,3.000,3.000,2.372,3.419,-0.327,-4.504,-0.496,-3.091,1.022,-2.111,0.164,-0.817,-2.522,-1.244,-1.390,0.146,-1.198,0.000}},
                {"CS-O.o1", Floats(this->pairwise_bin_num, 0.0)},
                {"CS-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"CB-C.ca", {3.000,3.000,3.000,3.000,2.923,1.873,-2.038,-2.563,-3.502,-2.128,0.573,1.241,1.231,0.470,-0.228,-0.967,-0.235,-0.524,0.229,0.000}},
                {"N*-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"OH-C.c3", {3.000,3.000,3.000,3.000,2.870,1.252,1.565,1.221,-1.293,-0.092,0.084,0.523,-0.940,-0.459,-0.042,0.001,0.915,0.583,-0.051,0.000}},
                {"CI-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"CA-C.c", {3.000,3.000,3.000,3.000,1.898,0.907,-0.587,-3.476,-5.847,-2.024,0.546,-2.095,-1.171,-1.466,-1.080,-0.592,-0.665,-1.857,-0.779,0.000}},
                {"NC-C.c", {3.000,3.000,3.000,3.000,3.225,3.000,0.334,-4.164,-0.763,-1.090,-0.750,1.055,-0.051,-1.371,-0.204,0.317,0.931,0.442,0.603,0.000}},
                {"C5-O.os", Floats(this->pairwise_bin_num, 0.0)},
                {"N*-N.nh", {3.000,3.000,3.000,3.000,2.531,2.910,1.691,-2.379,2.087,-3.577,-1.234,-1.541,0.585,-0.368,-1.681,-0.803,-1.658,0.149,-0.010,0.000}},
                {"RBA-S.*", {3.000,3.000,3.000,3.000,3.847,1.418,1.751,-1.602,-3.058,-0.950,-0.826,0.194,1.627,2.183,-0.542,1.126,1.188,-0.067,-0.001,0.000}},
                {"C4-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"P-C.ca", {3.000,3.000,3.000,3.000,3.276,3.286,3.145,3.025,1.511,1.485,0.613,0.315,-0.785,0.689,-0.537,0.685,0.718,0.229,0.115,0.000}},
                {"CB-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"CT-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"CS-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"C-N.nh", {3.000,3.000,3.000,3.000,3.038,4.868,-0.717,-7.470,0.076,-1.782,-1.283,-0.062,0.460,-0.381,-1.048,-0.199,-0.890,0.678,0.188,0.000}},
                {"O-N.nh", {3.000,3.000,3.000,3.000,4.748,-9.890,-3.460,-3.418,1.147,-1.373,-0.182,-1.543,-0.713,-0.485,-1.715,-0.941,-0.314,-1.000,-0.083,0.000}},
                {"OS-N.nh", {3.000,3.000,3.000,3.000,2.811,2.095,-0.254,1.393,-1.171,-0.637,0.349,-0.292,-0.932,-0.050,-1.320,-0.766,-0.617,-0.705,-1.228,0.000}},
                {"CB-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"OS-C.c", {3.000,3.000,3.000,3.000,3.426,3.720,1.986,0.106,3.106,1.371,0.797,-0.339,0.423,0.431,-0.215,-0.419,0.240,0.835,0.652,0.000}},
                {"CI-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"NB-N.n4", {3.000,3.000,3.000,3.000,2.175,-2.813,2.652,-3.843,-0.901,0.898,-1.133,-0.295,0.345,-0.067,-1.027,0.635,-0.255,-0.894,0.595,0.000}},
                {"OH-N.nc", {3.000,3.000,3.000,3.000,2.577,-3.860,2.018,0.269,-1.472,-0.634,-0.553,-0.610,-1.060,-0.907,-0.688,-0.423,-0.548,-1.419,-0.831,0.000}},
                {"O2-O.oh", {3.000,3.000,3.000,3.000,0.523,2.628,1.326,1.673,-1.013,-2.067,1.311,-0.304,-1.107,-1.239,1.844,-0.026,-0.080,0.211,0.203,0.000}},
                {"N2-N.nb", {3.000,3.000,3.000,3.000,3.536,2.246,0.438,-2.067,0.838,-0.839,0.368,-0.539,0.883,-1.805,-0.401,0.335,-0.351,1.101,0.793,0.000}},
                {"O-N.nc", {3.000,3.000,3.000,3.000,3.755,0.633,-3.072,-3.515,-0.608,-1.453,-2.428,0.590,0.643,-0.965,-1.491,-0.879,-0.076,0.128,1.049,0.000}},
                {"N2-C.c3", {3.000,3.000,3.000,3.000,3.228,2.112,3.098,0.253,-1.283,-0.938,0.170,-0.672,-0.396,0.072,-0.655,-1.521,-1.446,-0.030,-0.924,0.000}},
                {"OS-O.oh", {3.000,3.000,3.000,3.000,3.694,2.849,-0.932,1.254,0.966,-0.604,0.241,0.979,-0.539,1.366,0.407,0.143,-0.131,0.920,0.463,0.000}},
                {"C-N.nb", {3.000,3.000,3.000,3.000,2.845,3.382,0.736,-3.014,-2.213,1.042,0.169,-1.385,0.516,-0.755,-0.923,-0.143,-0.099,0.910,-0.681,0.000}},
                {"C-C.ca", {3.000,3.000,3.000,3.000,2.823,3.320,1.526,-3.038,-3.158,-3.110,0.341,0.978,-0.125,0.019,-1.560,-1.304,-0.345,-0.257,-0.024,0.000}},
                {"CT-N.nc", {3.000,3.000,3.000,3.000,2.860,3.162,3.303,-1.440,-0.088,-0.113,-0.328,-0.240,0.142,0.683,-0.679,0.041,-0.608,-0.440,-0.231,0.000}},
                {"OS-N.nb", {3.000,3.000,3.000,3.000,2.811,1.865,0.397,-0.925,0.596,-0.564,-0.880,0.861,0.370,-0.009,-1.336,-0.284,0.527,-1.057,-0.382,0.000}},
                {"CT-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"N*-O.os", {3.000,3.000,3.000,3.000,2.721,2.783,3.016,-0.191,-0.262,1.022,-0.191,-1.300,-0.304,-2.354,0.625,0.990,-0.589,-0.493,-0.507,0.000}},
                {"CQ-N.na", Floats(this->pairwise_bin_num, 0.0)},
                {"C4-O.oh", {3.000,3.000,3.000,3.000,4.040,4.422,2.670,0.208,2.607,2.354,0.975,2.097,1.359,1.615,0.966,1.272,1.543,-0.301,0.485,0.000}},
                {"P-N.na", Floats(this->pairwise_bin_num, 0.0)},
                {"C4-N.n4", Floats(this->pairwise_bin_num, 0.0)},
                {"C5-N.nh", Floats(this->pairwise_bin_num, 0.0)},
                {"O-O.os", {3.000,3.000,3.000,3.000,3.430,3.846,0.547,1.615,-1.664,1.035,0.105,1.206,1.527,0.785,-0.439,-0.906,0.248,1.379,0.148,0.000}},
                {"C4-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"O2-C.ca", {3.000,3.000,3.000,3.000,3.000,3.440,1.249,2.798,0.745,0.109,-0.341,0.131,-0.775,-0.556,0.096,0.022,-0.531,0.024,0.174,0.000}},
                {"CS-N.nb", Floats(this->pairwise_bin_num, 0.0)},
                {"O2-C.c3", {3.000,3.000,3.000,3.000,3.374,4.623,-2.175,-3.411,-0.931,-1.662,-0.865,0.409,-0.144,-0.414,0.264,0.119,0.560,0.351,0.088,0.000}},
                {"CT-O.o1", {3.000,3.000,3.000,3.000,3.524,3.805,1.756,1.523,-0.409,-0.390,0.223,-0.799,0.855,0.759,0.922,0.368,1.389,0.087,-0.256,0.000}},
                {"OS-C.c2", {3.000,3.000,3.000,3.000,2.591,2.846,0.766,-3.516,0.866,-1.293,-1.787,-1.441,0.890,0.357,-1.399,-0.658,-0.474,-1.115,-0.157,0.000}},
                {"CT-C.cc", {3.000,3.000,3.000,3.000,2.321,2.437,3.019,0.108,-1.770,-2.250,-0.792,-2.148,-1.560,-0.857,0.040,-0.712,-0.216,-0.677,-1.228,0.000}},
                {"O-O.o2", {3.000,3.000,3.000,3.000,2.636,0.101,-0.468,-1.305,-0.610,-1.538,-2.543,-0.218,-1.143,-0.242,-2.617,-1.276,-1.255,-0.200,-0.394,0.000}},
                {"N*-O.o2", {3.000,3.000,3.000,3.000,0.421,2.224,-1.099,-0.747,2.180,-0.281,0.854,-0.681,-1.574,-0.803,-0.616,0.315,-1.408,-0.016,0.337,0.000}},
                {"O2-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"O2-N.nb", {3.000,3.000,3.000,3.000,4.334,4.403,4.537,4.499,4.586,2.839,2.610,2.803,2.258,1.702,1.221,0.831,1.220,1.557,1.405,0.000}},
                {"C5-C.cc", {3.000,3.000,3.000,3.000,2.974,2.889,0.319,-2.232,0.722,-1.215,-1.085,-0.009,1.111,0.006,-0.347,-0.438,-0.412,0.716,0.088,0.000}},
                {"CP-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"N2-O.os", {3.000,3.000,3.000,3.000,2.661,2.053,-1.339,-2.228,-0.745,0.596,-0.708,-0.811,-0.010,0.459,-1.203,-1.336,-1.341,-1.139,-0.878,0.000}},
                {"C5-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"NB-N.nb", Floats(this->pairwise_bin_num, 0.0)},
                {"N*-N.nc", {3.000,3.000,3.000,3.000,1.801,1.996,0.246,-3.050,-3.420,-2.108,-1.108,0.251,-1.192,-1.233,-2.038,-2.334,-1.375,-0.754,-1.170,0.000}},
                {"P-O.o1", Floats(this->pairwise_bin_num, 0.0)},
                {"CQ-C.cc", {3.000,3.000,3.000,3.000,2.994,3.851,0.028,-5.808,0.033,-3.005,1.700,0.995,-0.302,-0.843,-0.216,-0.562,-0.636,-0.306,-0.491,0.000}},
                {"CA-C.ca", {3.000,3.000,3.000,3.000,3.407,1.489,0.941,-0.990,-2.327,-0.152,1.621,0.826,-0.037,-0.039,-0.145,0.181,0.200,0.755,0.988,0.000}},
                {"RBB-P.*", {3.000,3.000,3.000,3.000,2.936,2.640,3.313,1.782,0.936,0.694,0.989,-0.084,0.149,-0.308,-1.246,0.490,-0.464,-0.411,-0.163,0.000}},
                {"NB-C.ca", {3.000,3.000,3.000,3.000,2.635,2.741,0.121,-2.904,-3.017,1.303,-1.175,-1.531,1.098,0.242,-1.295,-0.631,-0.707,-1.167,-0.108,0.000}},
                {"O2-O.o1", {3.000,3.000,3.000,3.000,3.241,3.192,2.731,1.754,0.717,1.736,-0.188,-0.464,0.043,0.560,-0.252,-0.291,-1.835,-0.596,0.009,0.000}},
                {"RBB-R.cn", {3.000,3.000,3.000,3.000,2.991,3.801,-0.714,-1.524,-1.821,-1.585,-2.933,-0.862,0.651,-0.970,-0.006,1.349,0.154,-0.427,0.046,0.000}},
                {"O2-N.na", {3.000,3.000,3.000,3.000,3.741,4.085,0.947,1.743,1.819,2.077,2.060,0.716,1.169,1.226,0.295,1.223,1.122,-0.053,0.666,0.000}},
                {"NC-N.n4", {3.000,3.000,3.000,3.000,2.094,-1.810,-0.955,1.651,0.355,-1.236,-0.159,-1.500,-3.259,-1.059,-1.859,-2.229,-1.076,-1.387,-1.090,0.000}},
                {"NB-C.c", Floats(this->pairwise_bin_num, 0.0)},
                {"CQ-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"OS-C.c3", {3.000,3.000,3.000,3.000,3.226,3.901,1.730,0.582,0.531,-0.021,-0.465,-0.474,-0.628,0.684,-0.032,0.599,0.091,0.361,1.067,0.000}},
                {"P-O.oh", {3.000,3.000,3.000,3.000,3.463,3.915,0.980,-0.027,2.690,0.077,-0.902,0.362,-0.659,1.057,1.140,0.151,0.048,1.068,0.580,0.000}},
                {"OH-O.os", {3.000,3.000,3.000,3.000,3.387,2.124,0.596,2.316,0.370,0.767,1.038,-0.076,0.636,0.600,-0.023,1.151,0.150,1.331,1.371,0.000}},
                {"CI-O.oh", {3.000,3.000,3.000,3.000,2.926,3.291,0.463,2.263,-1.258,-0.103,-0.193,0.719,0.740,-0.196,-0.561,-1.172,0.374,-0.693,-0.084,0.000}},
                {"C4-C.cc", {3.000,3.000,3.000,3.000,3.273,3.397,2.994,0.239,1.096,1.304,-0.279,0.600,-0.680,-0.059,-0.500,-0.253,0.254,0.286,0.952,0.000}},
                {"O-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"NB-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"NB-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"CB-O.o2", {3.000,3.000,3.000,3.000,2.720,0.837,0.031,0.690,-0.850,-1.612,-2.576,-0.642,-0.539,-1.076,-1.322,-1.611,-0.800,-0.005,0.217,0.000}},
                {"N2-C.ca", {3.000,3.000,3.000,3.000,3.098,1.730,3.776,0.453,-2.037,-1.427,0.074,-0.065,-0.607,-1.552,-0.513,-0.778,-0.376,0.217,-0.201,0.000}},
                {"CA-N.nc", {3.000,3.000,3.000,3.000,2.451,0.979,1.077,-3.516,-2.018,-1.306,-1.636,-0.382,0.104,-1.451,-2.683,-1.205,0.504,-0.034,-0.204,0.000}},
                {"CP-O.o1", Floats(this->pairwise_bin_num, 0.0)},
                {"NC-C.cc", {3.000,3.000,3.000,3.000,2.763,3.434,-3.219,-6.370,-1.876,-1.428,-0.700,0.754,-0.196,-0.158,-1.200,-0.628,-0.474,-0.487,-0.715,0.000}},
                {"C4-C.c", Floats(this->pairwise_bin_num, 0.0)},
                {"C4-O.os", {3.000,3.000,3.000,3.000,3.523,3.623,3.597,0.756,2.377,1.802,1.777,1.749,0.856,0.524,-0.034,0.338,1.111,-0.254,-0.047,0.000}},
                {"N2-N.na", {3.000,3.000,3.000,3.000,2.715,1.755,0.417,-0.883,-2.934,0.188,-0.195,0.291,-0.896,-2.393,-1.674,-0.245,-0.611,0.650,-0.587,0.000}},
                {"CB-N.nb", {3.000,3.000,3.000,3.000,2.866,2.253,-0.551,-5.613,2.234,-2.502,0.398,-0.527,-0.266,-1.427,-0.174,0.219,0.162,0.121,0.415,0.000}},
                {"CP-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"N2-O.oh", {3.000,3.000,3.000,3.000,2.714,3.038,1.702,0.827,-1.029,0.652,-0.320,1.097,0.379,-0.614,-0.335,-0.472,0.030,-0.171,0.135,0.000}},
                {"CT-N.nb", {3.000,3.000,3.000,3.000,2.686,2.897,0.719,-0.838,-0.339,-0.788,-1.265,-0.385,-0.652,0.553,-1.178,-0.316,-0.865,0.307,-0.357,0.000}},
                {"CP-C.c3", {3.000,3.000,3.000,3.000,2.611,2.777,1.693,0.625,-3.820,-0.255,0.607,-0.915,-0.906,-0.309,-1.030,-0.941,-1.137,-0.172,-0.758,0.000}},
                {"CQ-O.o1", Floats(this->pairwise_bin_num, 0.0)},
                {"O-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"OS-N.nc", {3.000,3.000,3.000,3.000,3.113,3.065,2.101,0.624,0.120,2.756,0.489,-0.504,-0.080,0.579,0.036,-0.030,-0.112,-0.202,-0.406,0.000}},
                {"C5-N.n4", Floats(this->pairwise_bin_num, 0.0)},
                {"CS-N.nh", {3.000,3.000,3.000,3.000,2.635,-0.356,2.505,1.643,-2.609,-0.553,-1.099,-1.384,-2.011,-0.220,0.110,-0.311,0.598,-0.927,-0.519,0.000}},
                {"P-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"CQ-O.os", Floats(this->pairwise_bin_num, 0.0)},
                {"OH-C.c", {3.000,3.000,3.000,3.000,3.237,2.328,-1.778,0.273,-1.259,0.669,-0.913,1.528,0.023,0.303,0.542,-0.183,-0.201,0.115,0.279,0.000}},
                {"CB-O.o1", {3.000,3.000,3.000,3.000,3.189,3.498,4.275,2.008,-0.877,0.532,-0.029,1.062,-0.803,-0.245,-0.707,0.516,-0.478,0.005,-0.191,0.000}},
                {"CI-N.nh", {3.000,3.000,3.000,3.000,2.854,2.920,3.371,-0.434,-0.635,2.054,-0.149,0.360,-0.124,0.206,-0.256,-0.167,-1.427,-0.071,-0.354,0.000}},
                {"CT-C.ca", {3.000,3.000,3.000,3.000,2.532,2.853,3.137,-1.232,-1.859,-1.099,-0.844,-1.216,-1.409,-0.004,-0.436,0.077,-0.413,-1.143,-0.516,0.000}},
                {"C4-N.nh", Floats(this->pairwise_bin_num, 0.0)},
                {"O-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"CT-O.oh", {3.000,3.000,3.000,3.000,3.462,2.727,0.295,-0.007,-0.313,-1.410,0.784,1.405,0.852,0.563,0.083,0.528,-0.400,1.246,0.350,0.000}},
                {"NA-N.nc", Floats(this->pairwise_bin_num, 0.0)},
                {"NA-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"C4-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"P-N.n4", {3.000,3.000,3.000,3.000,2.779,2.901,-0.507,-2.209,-0.487,1.363,-0.694,-2.004,-1.966,0.357,-0.151,0.435,-0.071,0.135,-0.360,0.000}},
                {"OS-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"CQ-N.n4", Floats(this->pairwise_bin_num, 0.0)},
                {"OS-O.o1", {3.000,3.000,3.000,3.000,3.698,3.383,2.460,2.696,-0.266,0.949,1.064,0.606,1.018,0.396,0.032,1.151,0.198,0.115,-0.604,0.000}},
                {"NA-O.oh", {3.000,3.000,3.000,3.000,2.579,0.505,0.181,-0.079,1.119,-1.178,-0.836,-2.343,-2.667,-1.179,-1.441,-0.455,-1.216,-0.066,-0.063,0.000}},
                {"O-O.o1", {3.000,3.000,3.000,3.000,4.004,4.254,0.304,0.202,0.745,-2.142,-0.861,-1.720,-0.831,0.502,0.041,0.041,0.832,0.378,-0.009,0.000}},
                {"C5-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"CQ-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"N2-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"C-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"CB-N.nc", {3.000,3.000,3.000,3.000,2.133,1.928,-1.906,-4.429,-1.248,-0.380,-1.484,0.539,-1.469,-0.776,-1.469,-1.063,-1.564,-0.807,-1.060,0.000}},
                {"N*-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"N*-N.n4", {3.000,3.000,3.000,3.000,2.729,0.478,3.095,2.042,2.277,-2.193,-0.823,-0.709,1.057,1.343,-1.181,-1.055,-0.132,-1.303,-0.744,0.000}},
                {"CS-C.c3", {3.000,3.000,3.000,3.000,2.765,2.928,1.965,0.602,0.309,-1.487,-1.335,-1.609,-0.618,-0.338,-1.351,-0.222,-0.169,0.198,-0.553,0.000}},
                {"N*-C.c", {3.000,3.000,3.000,3.000,2.218,0.953,0.391,-1.395,-0.738,1.167,-2.204,-2.050,-1.015,0.379,-1.162,-1.841,-0.986,-0.781,-0.563,0.000}},
                {"OH-N.nb", {3.000,3.000,3.000,3.000,0.237,-4.193,1.323,3.644,0.848,0.404,-0.884,0.117,-1.355,-1.309,-0.208,0.246,-0.829,-0.321,-0.093,0.000}},
                {"O-O.oh", {3.000,3.000,3.000,3.000,3.342,3.030,1.569,-2.096,-2.741,-1.707,-2.403,-0.726,-0.769,-0.147,-0.116,-0.832,-1.946,-0.800,-1.147,0.000}},
                {"CA-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"C-N.n4", {3.000,3.000,3.000,3.000,3.110,2.408,-0.448,-1.564,-0.976,-0.907,-0.976,0.805,-0.671,0.285,0.316,-0.379,-0.845,0.280,1.440,0.000}},
                {"N*-C.ca", {3.000,3.000,3.000,3.000,2.453,2.200,-0.555,-2.583,-1.510,-1.615,-2.211,-0.323,-0.762,0.604,-1.288,-0.807,-0.220,-1.101,-0.078,0.000}},
                {"NA-O.o1", {3.000,3.000,3.000,3.000,-0.870,-4.803,-1.257,-0.395,-0.563,0.198,0.106,-0.809,-0.005,0.157,-0.888,-1.208,-1.213,-0.418,-1.274,0.000}},
                {"CA-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"NA-O.os", {3.000,3.000,3.000,3.000,3.135,2.641,0.190,-0.013,-1.728,0.789,1.550,-0.829,-1.165,0.501,0.787,1.060,0.011,-0.265,-0.236,0.000}},
                {"N2-N.nh", {3.000,3.000,3.000,3.000,3.621,2.633,1.323,-2.887,-1.356,-1.238,-1.132,-0.296,-0.474,-2.054,-0.136,-0.839,-0.105,-0.264,-0.401,0.000}},
                {"CS-N.na", Floats(this->pairwise_bin_num, 0.0)},
                {"CB-N.n4", {3.000,3.000,3.000,3.000,2.554,2.687,2.168,-1.308,-0.833,-1.778,-2.563,-0.259,1.044,-1.669,-0.111,-0.576,-1.974,0.705,-1.192,0.000}},
                {"N2-O.o1", {3.000,3.000,3.000,3.000,4.002,-1.849,-2.065,-1.434,-0.969,1.117,1.704,0.390,-0.898,0.963,-0.070,0.840,-0.268,0.803,0.199,0.000}},
                {"CI-N.nb", {3.000,3.000,3.000,3.000,3.233,3.238,3.294,1.028,0.973,0.620,0.270,0.511,1.073,-0.357,0.284,1.555,0.263,0.398,-1.020,0.000}},
                {"O2-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"CP-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"CB-O.oh", {3.000,3.000,3.000,3.000,3.382,3.375,1.015,1.563,-1.118,0.923,1.338,0.070,0.895,0.012,0.273,-0.468,0.622,0.033,0.288,0.000}},
                {"C-O.o2", {3.000,3.000,3.000,3.000,2.664,1.311,0.886,-3.476,0.925,-2.673,-3.024,-1.190,1.209,-0.847,-2.144,-2.255,-1.319,-0.722,-0.674,0.000}},
                {"C-N.nc", {3.000,3.000,3.000,3.000,3.092,4.317,-0.238,-7.119,-0.302,0.866,-0.038,-0.484,-0.186,-0.399,-1.455,-0.341,0.459,0.747,0.855,0.000}},
                {"CQ-C.c3", {3.000,3.000,3.000,3.000,2.971,3.256,2.661,0.932,-1.755,-2.990,0.125,-0.661,1.296,-0.930,-0.581,-1.325,0.014,0.549,0.035,0.000}},
                {"C5-C.ca", {3.000,3.000,3.000,3.000,2.294,2.443,-3.442,0.377,-1.672,-1.270,-0.242,-1.101,-1.404,-1.291,-0.157,-1.612,-0.678,-0.760,-0.182,0.000}},
                {"OH-N.n4", {3.000,3.000,3.000,3.000,1.359,-0.070,3.115,1.393,1.893,0.992,1.730,1.290,1.798,2.488,0.471,1.099,1.100,0.914,1.151,0.000}},
                {"CI-C.c", Floats(this->pairwise_bin_num, 0.0)},
                {"NA-N.na", Floats(this->pairwise_bin_num, 0.0)},
                {"C4-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"OH-O.oh", {3.000,3.000,3.000,3.000,1.407,1.183,-2.008,2.019,-1.715,-1.641,0.886,-0.166,0.832,-1.040,-0.065,-0.062,-0.413,-0.386,-0.556,0.000}},
                {"CS-O.oh", {3.000,3.000,3.000,3.000,3.167,2.447,-0.280,-1.027,-0.233,-0.442,0.589,0.083,-2.065,-0.233,-0.839,-0.980,0.105,1.330,0.855,0.000}},
                {"CT-C.c2", {3.000,3.000,3.000,3.000,2.800,2.855,2.821,0.457,0.119,-1.706,-1.954,-1.058,-1.944,0.960,1.267,-0.158,-0.096,0.269,-0.936,0.000}},
                {"CB-O.os", {3.000,3.000,3.000,3.000,3.885,4.218,2.799,0.740,1.573,0.123,0.169,1.148,-0.612,0.977,0.621,1.387,1.088,2.081,1.021,0.000}},
                {"C5-N.na", Floats(this->pairwise_bin_num, 0.0)},
                {"O2-O.os", {3.000,3.000,3.000,3.000,2.185,0.057,0.210,0.526,-0.148,-1.927,-1.578,0.201,0.181,-1.278,-0.418,-1.003,0.012,0.426,0.084,0.000}},
                {"CQ-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"CI-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"CI-O.os", {3.000,3.000,3.000,3.000,2.404,2.456,0.682,-1.591,0.011,0.319,0.041,-0.555,0.276,-0.447,-0.693,-0.784,-0.642,-1.264,-1.033,0.000}},
                {"CB-C.c", {3.000,3.000,3.000,3.000,2.924,1.243,2.329,0.143,-2.763,-0.727,1.235,-0.084,0.192,-2.060,-1.571,0.444,0.093,0.239,0.957,0.000}},
                {"NA-C.ca", {3.000,3.000,3.000,3.000,2.970,2.618,0.168,-4.082,-2.628,-0.073,-1.018,-0.619,0.699,-0.161,-1.292,-0.666,-0.652,-0.063,0.458,0.000}},
                {"NA-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"P-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"O-C.ca", {3.000,3.000,3.000,3.000,3.491,2.758,1.460,-1.500,-1.802,-2.138,-0.628,-0.965,0.201,-0.445,-0.801,-0.646,-0.940,-0.378,-0.052,0.000}},
                {"N*-O.o1", {3.000,3.000,3.000,3.000,4.068,4.383,0.548,2.564,1.097,2.281,2.472,0.126,1.045,1.540,0.938,0.770,0.240,1.945,0.949,0.000}},
                {"O2-N.n2", Floats(this->pairwise_bin_num, 0.0)},
                {"CP-N.nh", Floats(this->pairwise_bin_num, 0.0)},
                {"NC-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"N2-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"C-C.cc", {3.000,3.000,3.000,3.000,2.223,2.947,-0.696,-4.608,-3.479,-2.171,-0.356,-0.516,-0.845,-1.357,-1.132,-0.981,-1.106,-1.362,0.305,0.000}},
                {"CI-O.o1", {3.000,3.000,3.000,3.000,3.205,3.456,-0.465,0.578,1.960,2.100,1.817,-0.507,0.781,0.434,-0.082,-0.150,-0.642,-0.128,-0.009,0.000}},
                {"CA-N.n", Floats(this->pairwise_bin_num, 0.0)},
                {"N2-C.cc", {3.000,3.000,3.000,3.000,3.233,4.506,-0.974,0.241,-0.680,-0.551,-2.532,-0.424,-0.666,-1.162,-0.946,-0.651,-0.155,-0.098,0.520,0.000}},
                {"O2-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"OH-C.c2", Floats(this->pairwise_bin_num, 0.0)},
                {"CB-C.cc", {3.000,3.000,3.000,3.000,2.901,2.961,-0.751,-4.320,-1.617,-1.339,0.690,1.301,1.359,0.229,-0.112,-0.718,-0.684,-0.445,0.059,0.000}},
                {"CB-C.c3", {3.000,3.000,3.000,3.000,2.477,2.725,3.228,-2.727,-3.038,-0.636,-2.846,0.578,0.524,-0.276,-0.607,-1.413,-1.484,-0.947,0.010,0.000}},
                {"CP-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"CA-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"CQ-C.c", Floats(this->pairwise_bin_num, 0.0)},
                {"NC-C.ca", {3.000,3.000,3.000,3.000,2.712,1.752,0.426,-4.774,-3.300,-1.305,-1.565,-0.071,0.567,-1.640,-1.281,-0.809,0.012,-0.291,-0.469,0.000}},
                {"CS-O.os", {3.000,3.000,3.000,3.000,3.289,3.650,0.613,0.045,0.904,0.970,1.576,0.034,0.694,0.174,1.152,0.939,-1.006,-0.219,-0.095,0.000}},
                {"C5-N.n3", Floats(this->pairwise_bin_num, 0.0)},
                {"NC-N.nc", {3.000,3.000,3.000,3.000,2.594,1.868,-2.021,-5.779,-0.788,-1.311,-1.852,-0.081,-1.549,-1.297,-2.156,-0.473,-1.481,-0.406,-0.593,0.000}},
                {"P-O.o2", Floats(this->pairwise_bin_num, 0.0)},
                {"N*-O.oh", {3.000,3.000,3.000,3.000,2.993,1.449,1.395,-1.067,-0.180,-0.389,0.839,0.638,0.152,1.358,0.506,-0.819,-0.976,-0.150,-0.325,0.000}},
                {"CQ-N.nb", Floats(this->pairwise_bin_num, 0.0)},
                {"NB-N.nc", Floats(this->pairwise_bin_num, 0.0)},
                {"O-C.c", {3.000,3.000,3.000,3.000,2.920,4.385,0.818,-2.895,-0.228,-1.883,-2.028,-0.834,-1.619,-0.290,-1.653,-0.095,-1.269,-0.012,-0.818,0.000}},
                {"CQ-C.ca", {3.000,3.000,3.000,3.000,2.619,0.736,-0.261,-6.167,-2.725,-1.500,-0.197,-1.537,0.473,-0.645,-1.955,-1.411,0.468,0.645,-0.769,0.000}},
                {"P-C.cc", {3.000,3.000,3.000,3.000,2.779,2.780,2.813,2.671,2.984,1.197,-0.179,0.980,0.880,-0.977,0.372,-1.457,-0.312,-0.468,-0.537,0.000}},
                {"N*-N.na", {3.000,3.000,3.000,3.000,3.038,3.143,1.265,-1.204,0.513,-1.581,-2.504,0.861,0.376,0.776,-0.280,0.659,-0.979,0.192,0.773,0.000}},
                {"CP-N.nb", Floats(this->pairwise_bin_num, 0.0)},
                {"OH-N.n3", Floats(this->pairwise_bin_num, 0.0)}
            };
            assert(this->pairwise_potentials_map.at("C-C.c3").size() == pairwise_bin_num);
        }
    }

    void info() const {
        std::cout << "************************************************" << std::endl;
        std::cout << "*                PARAMETER INFO                *" << std::endl;
        std::cout << "************************************************" << std::endl;
        std::cout << "T: " << T << std::endl;
        std::cout << "rt_to_kcal_per_mol: " << rt_to_kcal_per_mol << std::endl;
        std::cout << "gamma_SASA: " << gamma_SASA << std::endl;
        std::cout << "r_water: " << r_water << std::endl;
        std::cout << "pairwise_dis_upper_bound: " << pairwise_dis_upper_bound << std::endl;
        std::cout << "pairwise_bin_size: " << pairwise_bin_size << std::endl;
        std::cout << "pairwise_bin_num: " << pairwise_bin_num << std::endl;
        std::cout << "pairwise_potentials_map.size(): " << pairwise_potentials_map.size() << std::endl;
        std::cout << "sasa_points.size(): " << sasa_points.size() << std::endl;
    }

  private:
    void generate_sasa_table() {
        //Golden section spiral to generate quasi-uniformly distributed points on sphere
        //http://web.archive.org/web/20120421191837/http://www.cgafaq.info/wiki/Evenly_distributed_points_on_sphere
        //prepare_sasa_lookup
        this->sasa_points.resize(elem_radii.size(), std::vector<Vec3d>());
        for(Size_Type i = 0; i != elem_radii.size(); i++) {
            const Float rr = elem_radii[i]+this->r_water;
            const Size_Type unit_N = 1000; // num of test points for unit sphere
            // num of test points for the atom
            const Size_Type N = unit_N * rr * rr;
            this->sasa_points[i] = std::vector<Vec3d>(N);
            const Float dphi = k_pi * (3.0 - std::sqrt(5.0)); // golden section?
            const Float dz = 2.0 / N; // increments in z direction
            Float phi = 0.0;
            Float z = 1.0 - dz / 2.0;
            std::vector<Vec3d>& points = this->sasa_points[i];
            for(Size_Type i = 0; i < N; i++) {
                const Float r = std::sqrt(1.0 - z * z);
                points[i] = Vec3d(std::cos(phi)*r, std::sin(phi)*r, z) * rr;
                z -= dz;
                phi += dphi;
            }
        }
    }
};

}
